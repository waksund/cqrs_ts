# Books shop

Бэкенд для книжного магазина.
Предоставляет следующие функции:
1. Начать регистрацию. При этом создается пользователь в БД и ему на почту отправляется код подтверждения.
2. Логин. Пользователь уже должен быть создан в систему. Ему на почту отправляется код подтверждения.
3. Подтверждения временного кода. Если пользователь ранее не был зарегистрирован, то при этом действии происходит пометка о его регистрации, начисления бонусов и отправка письма с подтверждением.
4. Создать книгу. При этом действии происходит сохранение книги в БД.
5. Оценить книгу. При этом действии происходит сохранение оценки от 0 до 5 в БД.
6. Получить список книг. Метод возвращает список книг с информацией об авторе и средней оценкой.

### Первый вариант решения
Представляет из себя приложение, где вся бизнес логика, логика работы с провайдерами и БД находится в контроллерах.

### Второй вариант решения
Два приложения. Одно предоставляет Command функционал, а второе отвечает за запросы. Слой Application представлен в виде набора сервисов.

### Третий вариант решения
Как и во втором - представляет из себя два приложения - Command и Query. Оба приложения построены c использованием команд и CommandBus.

## Монорепо, состоящее из пяти приложений

* `spaghetti` - приложение, содержащее весь функционал в контроллерах
* `services-write` - write часть. Сервисный слой представляет собой ряд классов - сервисов
* `services-read` - read часть. Сервисный слой представляет собой ряд классов - сервисов
* `commands-write` - write часть. Сервисный слой представляет собой ряд команд
* `commands-read` - write часть. Сервисный слой представляет собой ряд запросов

## Переменные окружения

* `APP_PORT` [3000]
* `DB_URL` [postgres://user_name:user_password@localhost:5432/cqrs_ts]
* `DB_LOGGING` [true]
* `REDIS_HOST`
* `REDIS_PASSWORD`
* `REDIS_PORT`

## Scripts

```shell
npm run start:spaghetti
```

```shell
npm run start:services-write
```

```shell
npm run start:services-read
```

```shell
npm run start:commands-write
```

```shell
npm run start:commands-read
```


